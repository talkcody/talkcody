---
title: 飞书远程控制
sidebarTitle: 飞书
description: 通过飞书在手机上发送消息，桌面端 TalkCody 执行任务并回传结果。
icon: Feishu
---

import { Callout } from 'fumadocs-ui/components/callout';

## 功能简介

飞书远程控制让你在手机飞书里发送消息，桌面端 TalkCody 在后台执行任务，并将结果流式回传到手机。

适合场景：

- 远程启动任务、随时查看进度
- 在通勤或外出时获取任务结果
- 处理需要长时间运行的任务

## 使用前准备

### 1. 创建飞书自建应用

1. 打开 [飞书开放平台](https://open.feishu.cn/app) 并登录
2. 点击「创建企业自建应用」
3. 填写应用名称（如「TalkCody 远程控制」）和描述
4. 点击「创建应用」
5. 启用 Bot 能力

![TalkCody feishu create](https://cdn.talkcody.com/images/feishu-create.png)

![TalkCody feishu bot](https://cdn.talkcody.com/images/feishu-bot.png)

### 2. 获取 App ID 和 App Secret

1. 进入应用详情页的「凭证与基础信息」
2. 复制 **App ID**（如 `cli_xxxxxxxxxx`）
3. 复制 **App Secret**（点击「查看」按钮显示）

<Callout type="warning">
请妥善保管 App Secret，不要泄露给他人。
</Callout>

### 3. 配置权限

1. 进入「权限管理」页面
2. 添加以下权限：
   - `im:message` - 发送消息

![TalkCody feishu permission](https://cdn.talkcody.com/images/feishu-permission.png)

![TalkCody feishu permission 2](https://cdn.talkcody.com/images/feishu-permission2.png)

### 4. 发布应用

1. 进入「版本管理与发布」页面
2. 点击「创建版本」
3. 填写版本号、更新说明等信息
4. 点击「申请发布」
5. 让管理员审核并发布应用

### 5. 在 TalkCody 中配置启用

1. 打开 TalkCody 设置页
2. 找到「飞书远程控制」
3. 打开「启用飞书远程控制」开关
4. 填写 **App ID**
5. 填写 **App Secret**
6. （可选）填写 **Encrypt Key** - 如果启用了事件加密
7. （可选）填写 **Verification Token** - 如果配置了验证 Token
8. （可选）填写 **允许的 Open IDs** - 多个 ID 用逗号分隔，留空允许所有
9. 保存设置

### 6. 添加 receive messages event

1. 选择长连接接收消息事件

![TalkCody feishu event 1](https://cdn.talkcody.com/images/feishu-event1.png)


2. 增加 im.message.receive_v1 事件

![TalkCody feishu event 2](https://cdn.talkcody.com/images/feishu-event2.png)

## 指令说明

| 指令 | 作用 | 示例 |
|------|------|------|
| `/new` | 新建任务 | `/new 帮我总结今天的会议记录` |
| `/status` | 查看当前任务状态 | `/status` |
| `/stop` | 停止当前任务 | `/stop` |
| `/model` | 切换模型 | `/model claude-sonnet-4-20250514` |
| `/project` | 切换项目 | `/project my-project` |
| `/agent` | 切换 Agent | `/agent code-reviewer` |
| `/list` | 查看列表（模型/项目/Agent） | `/list -p` 查看项目列表 |
| `/approve` | 批准文件编辑 | `/approve` |
| `/reject` | 拒绝文件编辑 | `/reject` |
| `/help` | 查看帮助 | `/help` |

## 支持的输入类型

飞书远程控制支持以下输入类型：

| 类型 | 说明 |
|------|------|
| 文字 | 纯文本消息 |
| 图片 | 上传的图片文件，最大 20MB |
| 语音 | 语音消息，自动转文字处理 |
| 文件 | 普通文件，最大 20MB |

## 核心流程

1. 飞书消息进入后，TalkCody 创建或复用对应任务
2. 执行任务时会持续把结果更新到飞书
3. 任务完成后会分段发送完整结果

## 常见问题

### 1. 为什么没有收到回复？

- 请确认 TalkCody 正在运行
- 请确认 App ID 和 App Secret 正确
- 请确认应用已发布并通过审核
- 请确认已添加必要的权限
- 如果设置了允许的 Open IDs，请确认当前用户在白名单中

### 2. 支持群聊吗？

当前版本仅支持私聊（P2P），群聊消息会被忽略。

### 3. 如何停止任务？

发送 `/stop` 即可停止当前任务。

<Callout type="info">
飞书远程控制使用 WebSocket 长连接实时接收消息，无需像 Telegram 那样配置轮询超时。
</Callout>
